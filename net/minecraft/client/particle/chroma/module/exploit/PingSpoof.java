package net.minecraft.client.particle.chroma.module.exploit;

import java.util.ArrayList;
import java.util.List;

import org.lwjgl.input.Keyboard;

import net.minecraft.client.particle.chroma.event.EventTarget;
import net.minecraft.client.particle.chroma.event.events.EventSentPacket;
import net.minecraft.client.particle.chroma.module.Category;
import net.minecraft.client.particle.chroma.module.Module;
import net.minecraft.client.particle.chroma.settings.Setting;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C00PacketKeepAlive;
import net.minecraft.network.play.client.C0FPacketConfirmTransaction;

public class PingSpoof extends Module
{
	public List keepAlives = new ArrayList();
	
	public PingSpoof()
	{
		super("PingSpoof", "Change the ping of the player to confuse the anticheat.", Keyboard.KEY_NONE, Category.EXPLOIT, false, 16);
	}
	
	@Override
	public void setup()
	{
		this.getSetManager().rSetting(new Setting(112, "Delay", "", this, 1500, 100, 5000, true));
		super.setup();
	}
	
	@EventTarget
	public void onSentPacket(EventSentPacket event)
	{
		if (event.getPacket() instanceof C00PacketKeepAlive)
		{
            if (this.keepAlives.contains(event.getPacket()))
            {
            	return;
            }
            
            event.setCancelled(true);
            Packet packet = event.getPacket();
            this.keepAlives.add((C00PacketKeepAlive)(event.getPacket()));
            
            (new Thread(() ->
            {
               try
               {
                  Thread.sleep((long)((Integer) this.getSetManager().getSettingById(112).getValueI()).intValue());
               }
               catch (InterruptedException var4)
               {
            	   
               }

               try
               {
                  mc.thePlayer.sendQueue.addToSendQueue(packet);
               }
               catch (Exception var3)
               {
                  ;
               }

               this.keepAlives.remove(packet);
            }, "KeepAlive-Delay")).start();
		}
	}
}